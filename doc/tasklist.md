# План разработки LLM-ассистента для Telegram

## Прогресс разработки

| Итерация | Статус | Дата завершения | Комментарий |
|----------|--------|-----------------|-------------|
| 1        | ✅     | 2025-08-05      | Создан базовый Telegram-бот с эхо-функциональностью |
| 2        | ✅     | 2025-08-06      | Интеграция с LLM через OpenRouter API |
| 3        | ✅     | 2025-08-06      | Реализовано управление диалогами с сохранением контекста |
| 4        | ✅     | 2025-08-06      | Реализованы сценарии приветствия и ответов на вопросы |
| 5        | ✅     | 2025-08-06      | Настроена контейнеризация и развертывание в Docker |
| 6        | ⬜     |                 | Развертывание в облачном сервисе |
| 7        | ✅     | 2025-08-06      | Мультирежимный ассистент с контекстным определением стиля |
| 8        | ⬜     |                 | Улучшение модели и форматирования |

## Итерация 1: Базовый Telegram-бот

- [x] Создать инструкцию по регистрации бота через BotFather в doc/guides
- [x] Настроить проект согласно [@vision.md](./vision.md)
- [x] Создать файл `.env` для конфигурации
- [x] Реализовать базовую структуру бота (echo-бот)
- [x] Настроить прямой запуск Python-скриптов
- [x] Протестировать отправку и получение сообщений

## Итерация 2: Интеграция с LLM

- [x] Настроить клиент для OpenRouter API
- [x] Создать базовый системный промпт
- [x] Реализовать отправку запросов к LLM
- [x] Добавить логирование запросов и ответов
- [x] Протестировать получение ответов от LLM
- [x] Создать инструкцию по регистрации на OpenRouter в doc/guides

## Итерация 3: Управление диалогами

- [x] Реализовать хранение истории диалогов в памяти
- [x] Добавить функцию получения истории диалога
- [x] Отправлять историю диалога в запросах к LLM
- [x] Протестировать поддержание контекста разговора

## Итерация 4: Сценарии работы

- [x] Реализовать сценарий приветствия
- [x] Добавить сценарий ответов на вопросы с предложением услуг
- [x] Улучшить системный промпт для сценариев
- [x] Протестировать работу сценариев

## Итерация 5: Контейнеризация и развертывание

- [x] Создать Dockerfile для приложения
- [x] Настроить Docker Compose для локального развертывания
- [x] Добавить инструкцию по запуску в Docker
- [x] Протестировать работу в контейнере

## Итерация 6: Облачное развертывание в Railway

- [x] Исследовать бесплатные облачные сервисы для развертывания (выбран Railway)
- [ ] Создать инструкцию по ручному развертыванию в Railway
- [ ] Подготовить проект к ручному развертыванию
- [ ] Протестировать развертывание и работу приложения в облаке

## Итерация 7: Мультирежимный ассистент

- [x] Создать системные промпты для трех режимов работы бота
  - [x] Переводчик с технического на кошачий
  - [x] Переводчик на язык суперзлодеев
  - [x] Драматический технический писатель
- [x] Реализовать механизм контекстного определения режима
- [x] Добавить возможность явного переключения режимов
- [x] Расширить память диалогов для хранения предпочтений пользователя
- [x] Протестировать работу мультирежимного ассистента

## Итерация 8: Улучшение модели и форматирования

- [x] Обновить модель LLM на лучшую бесплатную модель в OpenRouter
- [x] Исправить форматирование в промптах для корректного отображения в Telegram
- [ ] Протестировать работу бота с новой моделью
- [ ] Оптимизировать использование токенов в запросах к LLM